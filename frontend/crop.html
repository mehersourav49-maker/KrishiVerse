<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smart Crop Recommendation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url("images/bg.png") no-repeat center center/cover fixed;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 20px;
      padding: 40px;
      min-height: 100vh;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      width: 400px;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background: #28a745;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background: #218838;
    }
    #result, #aiResult {
      margin-top: 15px;
      font-size: 18px;
      font-weight: bold;
      color: #2c3e50;
    }
  </style>
</head>
<body>
  <!-- Existing card (kept as is, still connects to server) -->
  <div class="card">
    <h2>üå± Smart Crop Recommendation</h2>
    <form id="cropForm">
      <input type="number" id="N" placeholder="Nitrogen (N)" required>
      <input type="number" id="P" placeholder="Phosphorus (P)" required>
      <input type="number" id="K" placeholder="Potassium (K)" required>
      <input type="number" id="temperature" placeholder="Temperature (¬∞C)" required>
      <input type="number" id="humidity" placeholder="Humidity (%)" required>
      <input type="number" id="ph" placeholder="pH Value" step="0.1" required>
      <input type="number" id="rainfall" placeholder="Rainfall (mm)" required>
      <button type="submit">Get Recommendation</button>
    </form>
    <div id="result"></div>
  </div>

  <!-- New AI Recommendation Card (demo only) -->
  <div class="card">
    <h2>ü§ñ AI Recommendation</h2>
    <form id="aiForm">
      <label for="state">State</label>
      <input type="text" id="state" value="Odisha" readonly>

      <label for="district">District</label>
      <select id="district" required>
        <option value="">-- Select District --</option>
        <option value="Balangir">Balangir</option>
        <option value="Sonapur">Sonapur</option>
        <option value="Bargarh">bargarh</option>
        <option value="sambalpur">Sambalpur</option>
        <option value="khordha">Khordha</option>
      </select>

      <label for="block">Block</label>
      <select id="block" required>
        <option value="">-- Select Block --</option>
      </select>

      <button type="submit">Get AI Recommendation</button>
    </form>
    <div id="aiResult"></div>
  </div>

  <script>
    // ---------- Existing card logic (unchanged, server connection) ----------
    document.getElementById("cropForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const data = {
        N: parseFloat(document.getElementById("N").value),
        P: parseFloat(document.getElementById("P").value),
        K: parseFloat(document.getElementById("K").value),
        temperature: parseFloat(document.getElementById("temperature").value),
        humidity: parseFloat(document.getElementById("humidity").value),
        ph: parseFloat(document.getElementById("ph").value),
        rainfall: parseFloat(document.getElementById("rainfall").value)
      };

      try {
        const response = await fetch("http://127.0.0.1:5000/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        const result = await response.json();

        if (result.recommended_crop) {
          document.getElementById("result").innerText = "‚úÖ Recommended Crop: " + result.recommended_crop;
        } else {
          document.getElementById("result").innerText = "‚ö†Ô∏è Error: " + result.error;
        }
      } catch (error) {
        document.getElementById("result").innerText = "‚ùå Could not connect to server.";
      }
    });

    // ---------- Demo only for AI Recommendation card ----------
    const blockData = {
      Balangir: ["lohishinga", "Agalpur", "Patnagarh"],
      Sonapur: ["Binika", "Rampur", "Dunguripali"],
      puri: ["Puri Sadar", "Brahmagiri", "Kakatpur"],
      sambalpur: ["Rengali", "Dhankauda", "Kuchinda"],
      balasore: ["Balasore Sadar", "Nilgiri", "Jaleswar"]
    };

    const cropData = {
      Agalpur: ["Rice", "Vegetables",],
      Binika: ["Paddy", "Groundnut", "Pulses"],
      Bolagarh: ["Rice", "Sugarcane", "Vegetables"],
      "Cuttack Sadar": ["Paddy", "Mustard", "Vegetables"],
      Niali: ["Rice", "Jute", "Banana"],
      Tangi: ["Paddy", "Vegetables", "Pulses"],
      "Puri Sadar": ["Paddy", "Green Gram", "Sesame"],
      Brahmagiri: ["Paddy", "Coconut", "Vegetables"],
      Kakatpur: ["Rice", "Groundnut", "Pulses"],
      Rengali: ["Rice", "Vegetables", "Maize"],
      Dhankauda: ["Rice", "Sugarcane", "Oilseeds"],
      Kuchinda: ["Rice", "Vegetables", "Turmeric"],
      "Balasore Sadar": ["Paddy", "Betel Vine", "Vegetables"],
      Nilgiri: ["Rice", "Oilseeds", "Vegetables"],
      Jaleswar: ["Paddy", "Jute", "Vegetables"]
    };

    // Populate blocks dynamically
    document.getElementById("district").addEventListener("change", function() {
      const district = this.value;
      const blockSelect = document.getElementById("block");
      blockSelect.innerHTML = '<option value="">-- Select Block --</option>';

      if (blockData[district]) {
        blockData[district].forEach(block => {
          const option = document.createElement("option");
          option.value = block;
          option.textContent = block;
          blockSelect.appendChild(option);
        });
      }
    });

    // Show crops instantly (demo mode)
    document.getElementById("aiForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const block = document.getElementById("block").value;

      if (cropData[block]) {
        document.getElementById("aiResult").innerText =
          "ü§ñ Popular Crops in " + block + ": " + cropData[block].join(", ");
      } else {
        document.getElementById("aiResult").innerText =
          "‚ö†Ô∏è No crop data available for this block.";
      }
    });
  </script>
</body>
</html>
